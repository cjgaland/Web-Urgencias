<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Peso estimado (APLS)</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{--c1:#0a5ea8;--c1d:#0a4c84;--bd:#e1eefc;--bg:#f7fbff;--bx:#d1d9e6;--tx:#0a4c84;--mut:#667085}
body{font-family:Roboto,Arial,sans-serif;margin:0;padding:20px}
.card{max-width:900px;margin:auto;background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,.05);padding:16px}
h1{font-size:1.25rem;margin:.25rem 0 1rem;color:var(--tx)}
.small{font-size:.9rem;color:var(--mut)}
fieldset{border:1px solid #e5e7eb;border-radius:12px;padding:.8rem;margin-bottom:.9rem}
legend{padding:0 .4rem;color:#334155;font-weight:700}
label{display:flex;flex-direction:column;gap:.4rem;margin:.25rem 0}
input{border:1px solid var(--bx);border-radius:10px;padding:.55rem}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:.7rem}
.actions{display:flex;gap:.6rem;margin-top:.9rem;flex-wrap:wrap;align-items:center}
.btn{padding:.6rem .9rem;border-radius:10px;border:1px solid transparent;cursor:pointer;font-weight:500}
.btn.primary{background:var(--c1);color:#fff}.btn.primary:hover{background:var(--c1d)}
.btn.secondary{background:#eef2f7;color:var(--tx);border-color:#d9e2ec}
.result{margin-top:1rem;padding:.9rem;border:1px solid var(--bd);background:var(--bg);border-radius:10px;white-space:pre-wrap;color:var(--tx)}
@media(max-width:860px){.grid{grid-template-columns:1fr}}

*{box-sizing:border-box}
select{max-width:100%}
.actions .spacer{flex:1 1 auto}
.btn.close{margin-left:auto;background:#08406a;color:#fff;border-color:#083554}
.btn.close:hover{filter:brightness(1.05)}</style>
</head>
<body>
<div class="card">
  <h1>Peso estimado según edad (APLS)</h1>
  <p class="small">
    Fórmulas APLS: 0–12 m → (0.5 × meses) + 4 · 1–5 a → (2 × edad) + 8 · 6–12 a → (3 × edad) + 7.
  </p>

  <form id="f">
    <fieldset>
      <legend>Edad</legend>
      <div class="grid">
        <label>Menores de 1 año – Meses
          <input type="number" id="months" min="0" max="12" step="1" placeholder="0–12">
        </label>
        <label>Niños ≥1 año – Años
          <input type="number" id="years" min="1" max="12" step="1" placeholder="1–12">
        </label>
      </div>
    </fieldset>

    <div class="actions">
      <button type="button" class="btn primary" onclick="calc()">Calcular</button>
      <button type="button" class="btn secondary" onclick="copyRes()">Copiar</button>
      <button type="reset" class="btn secondary">Limpiar</button>
    
      <span class="spacer"></span>
      <button type="button" id="closeBtn" class="btn close" title="Cerrar esta ventana">Cerrar ventana</button>
</div>
  </form>

  <div id="res" class="result" aria-live="polite">Introduce meses o años y pulsa Calcular.</div>
    <p class="muted"><strong>Nota clínica:</strong> El peso estimado (APLS) es orientativo y puede variar por biotipo/estado nutricional. Ajusta medicación y material a <em>peso real</em> en cuanto sea posible.</p>

</div>

<script>
const r=(v,d=1)=>Math.round((v+Number.EPSILON)*10**d)/10**d;
function calc(){
  const months=parseFloat(document.getElementById('months').value||'');
  const years=parseFloat(document.getElementById('years').value||'');
  let w=null, formula='';
  if(!isNaN(months) && months>=0 && months<=12){
    w = 0.5*months + 4;
    formula = '0–12 m: (0.5 × meses) + 4';
  } else if(!isNaN(years) && years>=1 && years<=5){
    w = 2*years + 8;
    formula = '1–5 a: (2 × edad) + 8';
  } else if(!isNaN(years) && years>=6 && years<=12){
    w = 3*years + 7;
    formula = '6–12 a: (3 × edad) + 7';
  }
  if(w===null){ document.getElementById('res').textContent='Introduce meses (0–12) o años (1–12).'; return; }
  document.getElementById('res').textContent = `Peso estimado = ${r(w,1)} kg\nFórmula: ${formula}`;
}
function copyRes(){
  const t=document.getElementById('res').innerText||'';
  if(!t.trim()) return alert('No hay resultado.');
  navigator.clipboard.writeText(t);
}

// Cierre inteligente
function smartClose(){
  try{
    if(window.opener && !window.opener.closed){ window.close(); return; }
  }catch(e){}
  if(history.length>1){ history.back(); }
  else{ location.href='../index.html'; } // Ajusta si tu índice está en otra ruta
}
var _cb = document.getElementById('closeBtn');
if(_cb){ _cb.addEventListener('click', smartClose); }

</script>
</body>
</html>
