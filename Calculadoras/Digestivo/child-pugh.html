<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Child–Pugh (Clasificación)</title>
<style>
  :root{--c1:#0a5ea8;--c1-600:#0a4c84;--c1-700:#08406a;--bd:#e1eefc;--bg:#f7fbff;--bx:#d1d9e6;--tx:#0a4c84;--mut:#667085}
  *{box-sizing:border-box}
  body{font-family:Roboto,Arial,Helvetica,sans-serif;margin:0;padding:20px;background:#fff;color:#222}
  h1{font-size:1.25rem;margin:.25rem 0 1rem;color:var(--tx)}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px 16px 18px;max-width:760px;margin:0 auto;box-shadow:0 4px 16px rgba(0,0,0,.05)}
  .sub{color:#475569;margin:-.4rem 0 .8rem;font-size:.95rem}
  .grid{display:grid;gap:.9rem}
  .row{display:grid;gap:.5rem;grid-template-columns:1fr 1fr;align-items:center}
  .ig{display:grid;grid-template-columns:1fr 180px;gap:.5rem}
  label{font-weight:600;color:#334155}
  input[type=number],select{border:1px solid var(--bx);border-radius:10px;padding:.6rem .65rem;font-size:1rem;width:100%}
  select{max-width:100%}
  .actions{display:flex;gap:.6rem;margin-top:.4rem;flex-wrap:wrap;align-items:center}
  .actions .spacer{flex:1 1 auto}
  .btn{padding:.6rem .9rem;border-radius:10px;border:1px solid transparent;cursor:pointer;font-weight:500}
  .btn.primary{background:var(--c1);color:#fff}.btn.primary:hover{background:var(--c1-600)}
  .btn.secondary{background:#eef2f7;color:var(--tx);border-color:#d9e2ec}.btn.secondary:hover{background:#e6ebf2}
  .btn.close{margin-left:auto;background:var(--c1-700);color:#fff;border-color:#083554}
  .btn.close:hover{filter:brightness(1.05)}
  .result{margin-top:.9rem;padding:.9rem;border:1px solid var(--bd);background:var(--bg);border-radius:10px;color:var(--tx);white-space:pre-wrap}
  .muted{color:var(--mut);font-size:.9rem}
  @media (max-width:560px){.row{grid-template-columns:1fr}.ig{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="card">
  <h1>Clasificación Child–Pugh</h1>
  <p class="sub">Cinco parámetros (1–3 puntos cada uno): bilirrubina, albúmina, TP/INR, ascitis, encefalopatía. Suma → clase A/B/C.</p>

  <form id="formChild" class="grid">
    <div class="row">
      <label for="bilirr">Bilirrubina sérica (mg/dL)</label>
      <select id="bilirr" required>
        <option value="1">&lt; 2 mg/dL (1 punto)</option>
        <option value="2">2 – 3 mg/dL (2 puntos)</option>
        <option value="3">&gt; 3 mg/dL (3 puntos)</option>
      </select>
    </div>

    <div class="row">
      <label for="albumina">Albúmina sérica (g/dL)</label>
      <select id="albumina" required>
        <option value="1">&gt; 3.5 g/dL (1 punto)</option>
        <option value="2">2.8 – 3.5 g/dL (2 puntos)</option>
        <option value="3">&lt; 2.8 g/dL (3 puntos)</option>
      </select>
    </div>

    <div class="row">
      <label for="coagulacion">Coagulación (elige criterio)</label>
      <div class="ig">
        <select id="coagModo">
          <option value="inr">INR</option>
          <option value="tp">Tiempo de protrombina (prolongación)</option>
        </select>
        <span></span>
      </div>
    </div>

    <div class="row" id="filaINR">
      <label for="inr">INR</label>
      <select id="inr">
        <option value="1">&lt; 1.7 (1 punto)</option>
        <option value="2">1.7 – 2.3 (2 puntos)</option>
        <option value="3">&gt; 2.3 (3 puntos)</option>
      </select>
    </div>

    <div class="row" id="filaTP" style="display:none">
      <label for="tp">TP (prolongación vs control)</label>
      <select id="tp">
        <option value="1">&lt; 4 s (1 punto)</option>
        <option value="2">4 – 6 s (2 puntos)</option>
        <option value="3">&gt; 6 s (3 puntos)</option>
      </select>
    </div>

    <div class="row">
      <label for="ascitis">Ascitis</label>
      <select id="ascitis" required>
        <option value="1">Ausente (1 punto)</option>
        <option value="2">Leve / controlada (2 puntos)</option>
        <option value="3">Moderada–severa / refractaria (3 puntos)</option>
      </select>
    </div>

    <div class="row">
      <label for="encef">Encefalopatía hepática</label>
      <select id="encef" required>
        <option value="1">Ausente (1 punto)</option>
        <option value="2">Grado I–II (2 puntos)</option>
        <option value="3">Grado III–IV (3 puntos)</option>
      </select>
    </div>

    <div class="actions">
      <button type="submit" class="btn primary">Calcular</button>
      <button type="button" id="copyBtn" class="btn secondary">Copiar resultado</button>
      <button type="reset" class="btn secondary">Limpiar</button>
      <span class="spacer"></span>
      <button type="button" id="closeBtn" class="btn close">Cerrar ventana</button>
    </div>

    <div id="resultado" class="result" aria-live="polite">Selecciona las categorías y pulsa “Calcular”.</div>

    <p class="muted">
      <strong>Recordatorio clínico (Child–Pugh):</strong>
      A = 5–6 puntos · B = 7–9 · C = 10–15. Herramienta pronóstica orientativa en hepatopatía crónica/cirrosis.
      La valoración de ascitis y encefalopatía es clínica; interpreta el resultado junto al contexto del paciente y otras escalas.
    </p>
  </form>
</div>

<script>
(function(){
  const $ = id => document.getElementById(id);

  // Alternar entre INR y TP
  $('coagModo').addEventListener('change', ()=>{
    const m = $('coagModo').value;
    $('filaINR').style.display = (m==='inr') ? 'grid' : 'none';
    $('filaTP').style.display  = (m==='tp')  ? 'grid' : 'none';
  });

  function calcularPuntos(){
    const b = parseInt($('bilirr').value,10);
    const a = parseInt($('albumina').value,10);
    const m = $('coagModo').value;
    const c = parseInt((m==='inr' ? $('inr').value : $('tp').value),10);
    const s = parseInt($('ascitis').value,10);
    const e = parseInt($('encef').value,10);
    return b + a + c + s + e;
  }

  function claseChild(p){
    if(p<=6) return 'A';
    if(p<=9) return 'B';
    return 'C';
  }

  $('formChild').addEventListener('submit', (ev)=>{
    ev.preventDefault();
    const puntos = calcularPuntos();
    const clase = claseChild(puntos);
    $('resultado').textContent = `Child–Pugh = ${puntos} puntos → Clase ${clase}`;
  });

  $('copyBtn').addEventListener('click', ()=>{
    const t = $('resultado').textContent || '';
    if(!t.trim()) return alert('No hay resultado.');
    navigator.clipboard.writeText(t).then(()=>{
      const b=$('copyBtn'); b.textContent='¡Copiado!'; setTimeout(()=>b.textContent='Copiar resultado',900);
    });
  });

  // Cierre inteligente
  function smartClose(){
    try{
      if(window.opener && !window.opener.closed){
        window.close(); return;
      }
    }catch(e){}
    if(history.length>1){ history.back(); }
    else{ location.href='../index.html'; } // ajusta si tu índice está en otra ruta
  }
  $('closeBtn').addEventListener('click', smartClose);
})();
</script>
</body>
</html>
