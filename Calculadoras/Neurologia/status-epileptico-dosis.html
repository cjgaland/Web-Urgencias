<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Status Epiléptico – Tratamiento</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
:root{
  --c1:#0a5ea8; --c1d:#0a4c84; --bd:#e1eefc; --bg:#f7fbff; --bx:#d1d9e6; --tx:#0a4c84;
  /* Colores bloques */
  --ok-bg:#ecfdf5; --ok-bd:#a7f3d0; --ok-tx:#065f46;
  --wrn-bg:#fff7ed; --wrn-bd:#fed7aa; --wrn-tx:#9a3412;
  --err-bg:#fef2f2; --err-bd:#fecaca; --err-tx:#991b1b;
}
*{box-sizing:border-box}
body{font-family:Roboto,Arial,sans-serif;margin:0;padding:20px;background:#fff}
.card{max-width:860px;margin:auto;background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 4px 16px rgba(0,0,0,.05);padding:16px}
h1{font-size:1.25rem;margin:.25rem 0 1rem;color:var(--tx)}
.small{font-size:.9rem;color:#667085}
label{display:flex;flex-direction:column;gap:.4rem;margin:.25rem 0;font-weight:600;color:#334155}
input{border:1px solid var(--bx);border-radius:10px;padding:.55rem}
.actions{display:flex;gap:.6rem;margin-top:.9rem;flex-wrap:wrap;align-items:center}
.btn{padding:.6rem .9rem;border-radius:10px;border:1px solid transparent;cursor:pointer;font-weight:500}
.btn.primary{background:var(--c1);color:#fff}.btn.primary:hover{background:var(--c1d)}
.btn.secondary{background:#eef2f7;color:var(--tx);border-color:#d9e2ec}
.result{margin-top:1rem;white-space:pre-wrap}

/* Bloques de fármacos */
.drug-block{
  border:1px solid #e5e7eb;background:#f9fafb;border-radius:12px;padding:0.9rem;margin-bottom:0.9rem;
  box-shadow:0 1px 3px rgba(0,0,0,.05)
}
.drug-block h3{font-size:1rem;margin:0 0 0.45rem 0;display:flex;align-items:center;gap:.5rem}
.drug-block p{margin:0.3rem 0;font-size:0.95rem;color:#374151}

/* Variantes por nivel */
.drug-block.ok{background:var(--ok-bg);border-color:var(--ok-bd);color:var(--ok-tx)}
.drug-block.ok h3{color:var(--ok-tx)}
.drug-block.warn{background:var(--wrn-bg);border-color:var(--wrn-bd);color:var(--wrn-tx)}
.drug-block.warn h3{color:var(--wrn-tx)}
.drug-block.danger{background:var(--err-bg);border-color:var(--err-bd);color:var(--err-tx)}
.drug-block.danger h3{color:var(--err-tx)}

.badge{
  display:inline-flex;align-items:center;gap:.4rem;
  font-size:.8rem;font-weight:700;letter-spacing:.2px;
  padding:.2rem .5rem;border-radius:999px;border:1px solid transparent
}
.badge.ok{background:var(--ok-bg);border-color:var(--ok-bd);color:var(--ok-tx)}
.badge.warn{background:var(--wrn-bg);border-color:var(--wrn-bd);color:var(--wrn-tx)}
.badge.danger{background:var(--err-bg);border-color:var(--err-bd);color:var(--err-tx)}
.icon{font-style:normal}

select{max-width:100%}
.actions .spacer{flex:1 1 auto}
.btn.close{margin-left:auto;background:#08406a;color:#fff;border-color:#083554}
.btn.close:hover{filter:brightness(1.05)}</style>
</head>
<body>
<div class="card">
  <h1>Status Epiléptico – Tratamiento</h1>
  <p class="small">Guía rápida de manejo secuencial del status epiléptico en adultos. Calcula dosis según peso.</p>

  <label>Peso del paciente (kg)
    <input type="number" id="weight" step="0.1" placeholder="Ej: 70">
  </label>

  <div class="actions">
    <button type="button" class="btn primary" onclick="calcular()">Calcular dosis</button>
    <button type="button" class="btn secondary" onclick="limpiar()">Limpiar</button>
  
      <span class="spacer"></span>
      <button type="button" id="closeBtn" class="btn close" title="Cerrar esta ventana">Cerrar ventana</button>
</div>

  <div id="result" class="result" aria-live="polite"></div>
    <p class="muted"><strong>Nota clínica:</strong> Ajustar dosis por peso y comorbilidad. Asegurar vía aérea, oxigenación y monitorización. Seguir el protocolo local (tiempos y secuencia de fármacos) y considerar UCI si refractario.</p>

</div>

<script>
function fmt(n,dec=1){return Number(n).toFixed(dec)}
function calcular(){
  const w = parseFloat(document.getElementById('weight').value);
  if(isNaN(w) || w<=0){ alert('Introduce un peso válido'); return; }

  // 1ª línea (benzodiacepinas)
  const diazepam = `${fmt(0.2*w)}–${fmt(0.5*w)} mg IV (máx 10 mg)`;
  const lorazepam = `${fmt(0.1*w)} mg IV (máx 4 mg)`;
  const midazolamIM = `${fmt(0.2*w)} mg IM (máx 10 mg)`;

  // 2ª línea (antiepilépticos de carga)
  const valproato = `${Math.round(20*w)}–${Math.round(40*w)} mg IV en 5–10 min`;
  const levetiracetam = `${Math.round(40*w)}–${Math.round(60*w)} mg IV en 5–10 min`;
  const fenitoina = `${Math.round(15*w)}–${Math.round(20*w)} mg IV (≤50 mg/min)`;

  document.getElementById('result').innerHTML = `
    <div class="drug-block ok">
      <h3><span class="badge ok"><span class="icon">✅</span> 1ª línea</span> Benzodiacepinas</h3>
      <p>Diazepam: ${diazepam}</p>
      <p>o Lorazepam: ${lorazepam}</p>
      <p>o Midazolam IM: ${midazolamIM}</p>
    </div>

    <div class="drug-block warn">
      <h3><span class="badge warn"><span class="icon">⚠️</span> 2ª línea</span> Carga antiepiléptica</h3>
      <p>Valproato: ${valproato}</p>
      <p>o Levetiracetam: ${levetiracetam}</p>
      <p>o Fenitoína: ${fenitoina}</p>
    </div>

    <div class="drug-block danger">
      <h3><span class="badge danger"><span class="icon">⛔</span> 3ª línea</span> Refractario (UCI)</h3>
      <p>Considerar anestesia: midazolam, propofol o pentobarbital según protocolo de UCI.</p>
      <p class="small">Monitorización avanzada, control de vía aérea, hemodinámica y EEG si disponible.</p>
    </div>
  `;
}
function limpiar(){
  document.getElementById('result').innerHTML = '';
  document.getElementById('weight').value = '';
}

// Cierre inteligente
function smartClose(){
  try{
    if(window.opener && !window.opener.closed){ window.close(); return; }
  }catch(e){}
  if(history.length>1){ history.back(); }
  else{ location.href='../index.html'; } // Ajusta si tu índice está en otra ruta
}
var _cb = document.getElementById('closeBtn');
if(_cb){ _cb.addEventListener('click', smartClose); }

</script>
</body>
</html>
